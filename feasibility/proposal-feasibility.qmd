---
title: "Feasibility of proposed dissertation aims"
author: Zane Billings
date: last-modified
date-format: iso
abstract: |
  This document is based on my
  [dissertation ideas list](https://docs.google.com/document/d/1g_lcgxEuWJYpPRCdciDBF  ruD2uiMxwiR74CI8lNzNZY/edit). This is a compilation of exploratory data analyses   with some writeup to determine if specific aims would be feasible for my   dissertation.
  
  Our exploratory data analyses use vaccine cohort data collected by Ted Ross at the   University of Georgia. Data are from the UGAFluVac cohort (2016 -- present) as well   as two previous studies conducted in Pennsylvania and Florida. All studies   collected longitudinal responses to a seasonal influenza vaccine from an open   cohort and took serum samples at the day of vaccination and 21 or 28 days   post-vaccination. Serum samples were used for HAI assays against the vaccine strain   as well as a panel of heterologous historical strains, with the panel being updated   as the vaccine recommendations changed.
  
  If possible, we plan to incorporate additional data from several other studies, with data accessible as part of the DIVERsity grant collaboration.
bibliography: refs.bib
format:
  docx:
    number-sections: true
    toc: true
    toc-depth: 1
execute: 
  echo: false
  message: false
  warning: false
---

# Quantify the effect of preexisting immunity on heterologous humoral immune response after recieving a seasonal influenza vaccine. {#sec-1}

* **Hypothesis**: Individuals with higher antibody titers prior to vaccination will boost less than naive individuals, but the magnitude of this difference will decrease as antigenic distance between the vaccine strain and test strain increases.
* **Significance**: Quantifying the patterns of immunity to heterologous strains is vital for evaluating the breadth of vaccine response.
* **Innovation**: Previous studies use simple measures of antigenic distance, such as year between strain isolation, and poor metrics of breadth (e.g. proportion of strains an individual seroconverts to, which is extremely sensitive to the panel of strains tested); or strains are treated as categorical (e.g. Yang's dissertation), which is a flexible modeling framework but may not be extensible to other strains. Incorporating sequence-based measures of antigenic distance provides a method of modeling immune response that may be generalizable to strains which were not explicitly tested.

## Background {#sec-1a}

For a review of major work on the topic in the context of influenza, see [@linderman2020] and [@oidtman2021]. In short, the mechanistic models used in [@zarnitsyna2015; @zarnitsyna2016] predict that fold change in antibody titer will be negatively associated with (log) prior titer, with an "antigen ceiling," or threshold, effect at high values of preexisting titer. That is, individuals will sufficiently high pre-vaccination titers will have rapidly diminishing returns (or even no boosting at all) from vaccination. Furthermore, the intercept of the response curve will be shifted upwards as vaccine dose increases, but the slope of the relationship will not change.

While the original paper tested the mechanistic model against some real data, the model only makes predictions for homologous responses (i.e., immune response to the strain that was used in the vaccine). However, activation of partially cross-protective memory responses to antigenically drifted influenza strains is a key component in determining the degree of protection conferred by vaccination. Notably, while protection against cross-reactive strains is generally desirable, activation of a memory response can result in the production of weakly neutralizing antibodies which provide little protection, but block the formation of novel, stronger antibody species by steric hindrance (the Zarnitsyna paper calls this mechanism "epitope masking"). Assessing the degree to which the immune response to heterologous strains follows this pattern would provide information about the breadth of the influenza immune response.

Furthermore, based on Amanda Skarlupka's ongoing work on the computation of antigenic distance, quantifying how the effect of preexisting immunity varies as antigenic distance between the vaccine strain and the assay strain decreases (and therefore, cross-protection decreases) would provide a flexible modeling approach that has the potential to be less dependent on the strains selected for testing. This would provide a flexible extension of Yang Ge's ongoing multilevel modeling project which treats influenza strains as an unordered categorical variable. While determining an appropriate functional form for incorporating antigenic distance may be difficult, in this framework, models trained on strains with a wide range of antigenic distances could produce predictions for any strain based on the antigenic distance with the vaccine strain, not just strains used in training. Differences between the two models could further be studied to determine how much of the impact of viral mismatch on the immune response is determined by antigenic distance.

## Exploratory data analysis {#sec-1b}

Initially, we plotted the fold change in antibody titer vs. the pre-vaccination antibody titer for each vaccine strain / test strain combination represented in the data. Each of these plots has one data point per person-year, and does not account for repeated measurements of the same person, but provides a rough equivalent of the plots shown in [@zarnitsyna2016]. @fig-LMexample shows one of these linear models. In the homologous case (left) we see a strong negative correlation, matching the predictions made by the mechanistic model. However, for distant strains (right) we observe much weaker correlations. The plots shown only show examples for two strains.

```{r}
#| label: fig-LMexample
#| layout: "[[45, -10, 45], [1]]"
#| fig-cap: |
#|   Fold change ('titerincrease') vs. log pre-vaccination HAI titer
#|   ('prevactiter') for two test strains.
#| fig-subcap:
#|   - |
#|     Homologous response: the test strain is the same as the vaccine strain.
#|   - |
#|     Heterologous response: the test strain used in the HAI assay is not the
#|     same as the strain used in the vaccine.
#| out.width: 100%
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/01-1a.png"))
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/01-1b.png"))
```

We then computed all of the linear models of this form, obtaining the slope for each vaccine/test strain combination. This slope coefficient represents the expected difference in fold change for a 1 log-unit increase in prevaccination antibody titer -- so a negative coefficient matches the predictions of the mechanistic model. When we plot these slopes against a crude measure of antigenic distance, as shown in @fig-SlopesPlot, (the difference in isolation years of the two strains), we see a general positive trend, indicating that **as strains become more antigenically distant, the effect of pre-existing titer diminishes**, matching our hypothesis.

```{r}
#| label: fig-SlopesPlot
#| fig-cap: |
#|   Estimated slopes for each combination of test strain and vaccine
#|   strain present in the data. Overall, as the calendar time between the
#|   emergence of the two strains increases, the estimate slope increases.
#|   Therefore, preexisting immunity has less of an impact on vaccine
#|   boosting for strains which are far from the vaccine in calendar time.
#|   Calendar time is only a rough approximation of antigenic similarity, but
#|   we expect better measurements to show the same general pattern.
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/01-2.png"))
```

Furthermore, if we stratify by the subtype of influenza in this plot (@fig-SlopesStrat), we see different relationships for each subtype/lineage. As expected, protection from A(H3N2) influenza diminishes the quickest, which tracks with A(H3N2) strains evolving faster than the other subtypes shown. 

```{r}
#| label: fig-SlopesStrat
#| fig-cap: |
#|   The estimate slopes vs. difference in isolation year, but this time
#|   stratified by subtype (for influenza A strains) or lineage (for influenza
#|   B strains). Influenza A(H3N2) and B (Yamagata-like lineage) show the
#|   strongest trends. The A(H1N1) subtype shows only a moderate trend, with
#|   several outliers, which could potentially be due to the inclusion of both
#|   2009 pandemic-like strains and pre-pandemic strains. Interestingly,
#|   B (Yamag) lineage shows the opposite trend, although the effect is
#|   weak. Notably, divergences in the B strains are quite recent and it is
#|   thought that cross-reactivity is significantly higher among influenza B
#|   strains due to the comparatively slower rate of antigenic drift.
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/01-3.png"))
```

## Analytical plan {#sec-1c}

* Incorporate several measures of antigenic distance calculated by Amanda.
* Fit multilevel Bayesian models with the ability to control for potential confounds, to isolate the effect of antigenic distance.
* Sensitivity analysis to determine the impact of measured strains, if possible.
* Post-hoc analysis of differences between antigenic distance metrics, given that all other measurements remain the same.
* This could potentially include modifications to Veronika's mechanistic model to incorporate heterologous responses (or more likely a separate aim).

## Feasibility assessment {#sec-1d}

Amanda has already computed the antigenic distance metrics for Ted's cohort data. If we intend to incorporate DIVERsity data, that will entail a substantial amount of new data cleaning, but this would be common across all dissertation aims. Furthermore, if other studies use different virus panels for assessing HAI data, the antigenic distance metrics for those would need to be computed.

If we want to incorporate any data other than HAI responses, there would be a significant learning curve for me. However, I feel confident in my ability to fit models to answer this question using Ted's cohort data with Amanda's calculated antigenic distance measurements. The last remaining question here would be the structure of the model, including what other variables should be included, and the parametric form for the inclusion of antigenic distance. If only using Ted's HAI data would be satisfactory (as an extension or alternative to Yang's model where strains are treated as categorical variables), I think this aim is completely feasible. My estimated time scale for a first draft (working only on this project) would be between 1 -- 3 months depending on any issues with combining the antigenic distance data from Amanda with Ted's cohort data, and resolving any remaining data cleaning issues with the data.

If Amanda's project is not finished yet, this would seem to entail completing Amanda's project first.

# Quantify differences in the effect of prevaccination immunity on vaccine response between vaccine doses and types using compiled data from the DIVERsity grant. {#sec-2}

* **Hypothesis**: the mechanistic models proposed by @zarnitsyna2016 are accurate for some patterns, but may need to be modified to account for vaccine dose and type more effectively.
* **Significance**: heterologous prevaccination immunity is likely the single biggest challenge for seasonal influenza vaccine design. Increased vaccine dose and certain vaccine types are more likely to overcome the "antigenic ceiling" effect and avoid being out-competed by the memory B-cell response. Understanding the effect of vaccine dose and type in this context can provide critical information for vaccine design.
* **Innovation**: most studies of prior immunity to influenza consider only homologous immunity, and often only control for prior immunity without any further considerations. Furthermore, multiple doses and vaccine types are often not considered in the same framework. Our proposal is explore the direct effect of prior (heterologous) immunity on response to multiple vaccine doses and types.

## Background {#sec-2a}

**This project is a proposed extension of the exploratory analysis I conducted during Year 1 / Fall Year 2 of my program.** Based on the predictions made by Veronika's models, we expect to see a linear decrease (on a log-log scale) between increase in antigen levels after vaccination and pre-vaccination antibody levels. Furthermore, Veronika's models demonstrate an "antigenic ceiling" effect, which has also been described by some of the Cobey group's work (will need to cite this). That is, if pre-existing antibody level is high enough, there are dramatically (non-linear) diminished returns for vaccination. We aim to see where Veronika's models make predictions that are supported by the data, and any systematic differences where they do not.

We would explore the effect of prior immunity to multiple strains of influenza, incorporating antigenic distance if possible (but this is not necessary to complete the project, and could provide further work after this project is done). We would determine where the effect of prior immunity on vaccination is similar to what is predict by [@zarnitsyna2016], and importantly, *where* the results differ. Any systematic patterns will be quantified.

We also plan to use sound epidemiological methods to control for host factors. For example, if there is a true effect of sex on vaccination, we would expect the lines described to be different between males and females in the study data. We can adjust for factors such as age, sex, and race.

We expect that different vaccine types might behave differently, especially with respect to vaccine dose. Therefore, we aim to inspect the effect of dose quantitatively (as a numeric variable), by analyzing several vaccines with different doses across multiple study sites. This would include the analysis of effect modification by the vaccine type. The mechanistic model predicts that increased dose would increase the magnitude of the slope between increase in antibody level and pre-existing titer, as well as modulate the antigenic ceiling effect by increasing the threshold at which diminishing returns are incurred.

## Exploratory data analysis {#sec-2b}

See @fig-LMexample-2 for an example of the most basic linear models *for homologous strains* under this framework. Here, the intercept of the line estimates the expected vaccine boost for a completely naive participant, and the slope estimates the expected decrease in boosting for each log-unit of pre-existing immunity. For this project, we would quantify all of the homologous slopes for vaccine strains in our data, controlling for confounders, as well as longitudinal responses where necessary (e.g. H1N1-California-2009 was a component of the seasonal influenza vaccine for several consecutive years, and thus the data in @fig-LMexample-2 include multiple observations from the same subject).

We would determine the effect of dose by including the effect of dose in the model. In @fig-LMdose-1, we show the same data as in @fig-LMexample-2, but stratified by vaccine dose (note that only participants over 65 were allowed to choose the high dose vaccine). @fig-LMdose-2 shows a different strain from the same cohort study (and as such includes some, but not all, of the same participants). Particularly, @fig-LMdose-1 shows a result that contrasts with the mechanistic model, while @fig-LMdose-2 shows results that are similar to the mechanistic model predictions. 

```{r}
#| label: fig-LMdose
#| layout: "[[45, -10, 45], [1]]"
#| fig-cap: |
#|   Fold change ('titerincrease') vs. log pre-vaccination HAI titer
#|   ('prevactiter') for two homologous vaccine/test assays using the
#|   UGAFluVac data. Both are stratified by dose (FluZone SD vs. FluZone HD).
#| fig-subcap:
#|   - |
#|     Vaccine strain H1N1-California-2009. The slopes are clearly not parallel,
#|     which is in opposition to the predictions of the mechanistic model.
#|   - |
#|     Vaccine strain H1N1-Michigan-2015. The slopes are very close to parallel,
#|     which is what we would expect if the mechanistic model was accurate to
#|     the true data generating process.
#| out.width: 100%
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/03-1a.png"))
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/03-1b.png"))
```

We have also previously worked on combining data from multiple vaccine types through a collaboration with Andrea Sant (@fig-LMsant). Since these two studies measured two different immune markers (T-cells vs. HAI titer), we could not directly combine measurements from the two studies. But this could be an overall benefit for the project, as we could address whether different immune markers match or differ from the model predictions consistently.

```{r}
#| label: fig-LMsant
#| layout: "[[45, -10, 45], [1]]"
#| fig-cap: |
#|   Fold change vs. log pre-existing immune marker for
#|   multiple vaccine types at the two study sites.
#| fig-subcap:
#|   - |
#|     Data provided by Andrea Sant at the University of Rochester. The immune
#|     marker used was strain-specific (H1N1-California-2009) CD4+ T-cell count.
#|   - |
#|     Data provided by Ted Ross at the University of Georgia. The immune
#|     marker used was HAI titer to H1N1-Michigan-2015, because the only
#|     cohort that received the FluMist vaccine included this vaccine
#|     component.
#| out.width: 100%
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/03-2a.png"))
knitr::include_graphics(here::here("Proposal-Feasibility/Figures/03-2b.png"))
```

## Analytical plan {#sec-2c}

* We would fit several linear models of log-log relationship between increase in antibody titer post-vaccination and pre-vaccination immunity, incorporating other effects (these could be simple and easily implemented frequentist models, potentially ranging to complex hierarchical Bayesian models which incorporate the multilevel structure of the data), and compare the coefficients of these models.
* For example, the Zarnitsyna models expect the slope for the relationship between fold change in titer and log pre-existing antibody titer to be parallel for same doses of the different vaccine. We could determine "how" parallel the slopes are for each of the strains. Alternatively, we could compare the fit of the variable slopes model to the fit of the parallel slopes model, where the lines are constrained to be parallel.
* We would incorporate dose and type as effect modifiers of this relationship. Furthermore, we would control appropriately for demographic factors to mitigate confounding by measured variables in the estimates. If multiple study sites have data on the same immune markers and vaccines, we could pool these data together using either the hierarchical framework or a meta-analytic framework, which handles error pooling in a different way.

## Feasibility analysis {#sec-2d}

**This aim may be significantly more feasible if limited to the homologous case.** Many of the DIVERsity datasets will likely not include heterologous information anyways, and this also avoids co-dependency on the antigenic distance project. Merging the two ideas together could be a potential project after both are completed.

If we only have access to Ted Ross' UGAFluVac data (and Andrea Sant's data), only part of this analysis can be completed. While the UGAFluVac data contains data on three vaccine types (FluZone, FluBlok, and FluMist), the sample sizes for FluBlok and FluMist are smaller and do not contain the longitudinal component that is present in the FluZone cohort. While the data contains participants who received both FluZone SD and FluZone HD, the high dose vaccine recipients are limited to participants who are over 65 (and also elected to receive the HD vaccine), which limits the sample size and likely conditions the subsample on a confounder. (This limitation may not be exclusive to the UGAFluVac data, but at time of writing, these are the only data that I have access to.) We could compare the responses between Ted's data and Andrea's data, but with only these two data sources, it is impossible to say whether differences are truly caused by the vaccine type, or if they are caused by differences in protocols (or whatever else) between the two study sites.

Whether this aim is feasible or not completely depends on how quickly we get access to the DIVERsity data sources, and how compatible all the data is (and of course how difficult it is to combine the data). Even if data are able to be combined there are potentially issues with group sizes -- e.g. if three studies collect HAI data on two vaccine candidates, and then one study collects HAI data on a third vaccine candidate, it is impossible to say whether any differences with the third vaccine candidate are because the candidate is actually different or because of study site differences.

Overall, I think this is a potentially very interesting project, but I'm hesitant to list any aims for my dissertation that require me to work with data that I might not get until a month before I have to defend. We would need to discuss whether the portion of the project that can be completed with only Ted's data is sufficient.

# Summary measures for antigenic landscapes. {#sec-3}


The main goal of this project would be to analyze the antigenic landscapes of consistently high responders. If an individual responds well to one strain, how many, and which strains, do they also tend to respond well to? What host factors are associated with these patterns? See Sarah Cobey's comments during the DIVERsity November 2022 meeting.

I think this aim is potentially feasible, since Amanda has already calculated the antigenic landscapes. The difficult part would be figuring out how to quantify the similarity of antigenic landscapes

## Original section 6

* In Amanda's original paper, the main summary considered for an antigenic landscape is the AUROCC under a linear regression fit. This project would be a follow-up on Ben Cowling's idea to utilize both the slope and intercept of the linear regression fit to describe the landscape. The slope and intercept of the antigenic landscape fit might be good indicators of breadth and magnitude respectively, but using AUC can disguise the difference between these two things.

* The main barrier of the feasibility for this project to me is taking this general idea and turning it into a specific question -- maybe I'll have a better idea for this after reading Amanda's antigenic distance manuscript. How do we get from "we think slope and intercept describe breadth and magnitude of the response" to showing why they are useful?

* Sarah Cobey's idea on investigating landscapes of high responders potentially fits into this aim well also -- we could determine whether high responders tend to have higher intercepts, slopes, or both or neither.

* Would we also want to find other potential summaries and incorporate these into this paper? E.g. time above threshold that Amanda discussed but did not use in her analysis.

## Combining these aims

* Summary measures of antigenic landscapes -- is AUC the best, or can we
use something else (e.g. intercept/slope).
* Case study: what patterns do we see in slopes/intercepts across high/low
responders?
* How does this compare to using strain-specific antigenic distance measurements?
An ideal measure would condense an individual's entire landscape into an easy
to understand summary. Ideally this would allow for fair comparisons across
different panels of viruses.

* **Hypothesis**:
* **Significance**:
* **Innovation**: 

# References
